---
layout: post
title: λ¨λ“  κ°λ°μλ¥Ό μ„ν• HTTP κΈ°λ³Έμ§€μ‹ 7νΈ π
date: 2022-03-29 16:00 +0800
# last_modified_at: 2022-02-16 01:08:25 +0800
tags: [http]
toc: true
math: false
---

![lecture](https://cdn.inflearn.com/public/courses/326277/cover/52d4f143-b470-4109-96cb-a0b146fb42ed/http.png)

# HTTP Header 2 - μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­

## π“¦οΈ μΊμ‹ κΈ°λ³Έ λ™μ‘

### μΊμ‹κ°€ μ—†μ„ λ•

- λ°μ΄ν„°κ°€ λ³€κ²½λμ§€ μ•μ•„λ„ κ³„μ† λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄μ„ λ°μ΄ν„°λ¥Ό λ‹¤μ΄λ΅λ“ λ°›μ•„μ•Ό ν•λ‹¤.

- μΈν„°λ„· λ„¤νΈμ›ν¬λ” λ§¤μ° λλ¦¬κ³  λΉ„μ‹Έλ‹¤.

- λΈλΌμ°μ € λ΅λ”© μ†λ„κ°€ λλ¦¬λ‹¤.

- λλ¦° μ‚¬μ©μ κ²½ν—

### μΊμ‹ μ μ©

- μΊμ‹ λ•λ¶„μ— μΊμ‹ κ°€λ¥ μ‹κ°„λ™μ• λ„¤νΈμ›ν¬λ¥Ό μ‚¬μ©ν•μ§€ μ•μ•„λ„ λλ‹¤.

- λΉ„μ‹Ό λ„¤νΈμ›ν¬ μ‚¬μ©λ‰μ„ μ¤„μΌ μ μλ‹¤.

- λΈλΌμ°μ € λ΅λ”© μ†λ„κ°€ λ§¤μ° λΉ λ¥΄λ‹¤.

- λΉ λ¥Έ μ‚¬μ©μ κ²½ν—

### μΊμ‹ μ‹κ°„ μ΄κ³Ό

- μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•λ©΄, μ„λ²„λ¥Ό ν†µν•΄ λ°μ΄ν„°λ¥Ό λ‹¤μ‹ μ΅°νν•κ³ , μΊμ‹λ¥Ό κ°±μ‹ ν•λ‹¤.

- μ΄λ• λ‹¤μ‹ λ„¤νΈμ›ν¬ λ‹¤μ΄λ΅λ“κ°€ λ°μƒν•λ‹¤.

---

## π’¬ κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ 1

- μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•΄μ„ μ„λ²„μ— λ‹¤μ‹ μ”μ²­ν•λ©΄ λ‹¤μ λ‘ κ°€μ§€ μƒν™©μ΄ λ‚νƒ€λ‚λ‹¤.
  1. μ„λ²„μ—μ„ κΈ°μ΅΄ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•¨
  2. μ„λ²„μ—μ„ κΈ°μ΅΄ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•μ§€ μ•μ

### μΊμ‹ μ‹κ°„ μ΄κ³Ό

- μΊμ‹ λ§λ£ν›„μ—λ„ μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•μ§€ μ•μ
- μƒκ°ν•΄λ³΄λ©΄ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•λ” λ€μ‹ μ— μ €μ¥ν•΄ λ‘μ—λ μΊμ‹λ¥Ό μ¬μ‚¬μ© ν•  μ μλ‹¤.
- λ‹¨ ν΄λΌμ΄μ–ΈνΈμ λ°μ΄ν„°μ™€ μ„λ²„μ λ°μ΄ν„°κ°€ κ°™λ‹¤λ” μ‚¬μ‹¤μ„ ν™•μΈν•  μ μλ” λ°©λ²•μ΄ ν•„μ”

### κ²€μ¦ ν—¤λ” μ¶”κ°€

- μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•΄λ„, μ„λ²„μ λ°μ΄ν„°κ°€ κ°±μ‹ λμ§€ μ•μΌλ©΄ 304 Not Modified + ν—¤λ” λ©”νƒ€ μ •λ³΄λ§ μ‘λ‹µ(λ°”λ”” X)

- ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„κ°€ λ³΄λ‚Έ μ‘λ‹µ ν—¤λ” μ •λ³΄λ΅ μΊμ‹μ λ©”νƒ€ μ •λ³΄λ¥Ό κ°±μ‹ 

- ν΄λΌμ΄μ–ΈνΈλ” μΊμ‹μ— μ €μ¥λμ–΄ μλ” λ°μ΄ν„° μ¬ν™μ©

- κ²°κ³Όμ μΌλ΅ λ„¤νΈμ›ν¬ λ‹¤μ΄λ΅λ“κ°€ λ°μƒν•μ§€λ§ μ©λ‰μ΄ μ μ€ ν—¤λ” μ •λ³΄λ§ λ‹¤μ΄λ΅λ“

- λ§¤μ° μ‹¤μ©μ μΈ ν•΄κ²°μ±…

---

## π’¬ κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ 2

- κ²€μ¦ ν—¤λ”

  - μΊμ‹ λ°μ΄ν„°μ™€ μ„λ²„ λ°μ΄ν„°κ°€ κ°™μ€μ§€ κ²€μ¦ν•λ” λ°μ΄ν„°
  - Last-Modified, ETag

- μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”

  - κ²€μ¦ ν—¤λ”λ΅ μ΅°κ±΄μ— λ”°λ¥Έ λ¶„κΈ°
  - if-Modified-Since : Last-Modified μ‚¬μ©
  - if-None-Match : ETag μ‚¬μ©
  - μ΅°κ±΄μ΄ λ§μ΅±ν•λ©΄ 200 OK
  - μ΅°κ±΄μ΄ λ§μ΅±ν•μ§€ μ•μΌλ©΄ 304 Not Modified

- if-Modified-Since : μ΄ν›„μ— λ°μ΄ν„°κ°€ μμ •λμ—μΌλ©΄ ?

  - λ°μ΄ν„° λ―Έλ³€κ²½ μμ‹

    - μΊμ‹: 2020λ…„ 11μ›” 10μΌ 10:00:00 vs μ„λ²„: 2020λ…„ 11μ›” 10μΌ 10:00:00
    - 304 Not Modified, ν—¤λ” λ°μ΄ν„°λ§ μ „μ†΅(BODY λ―Έν¬ν•¨)
    - μ „μ†΅ μ©λ‰ 0.1M (ν—¤λ” 0.1M, λ°”λ”” 1.0M)

  - λ°μ΄ν„° λ³€κ²½ μμ‹

    - μΊμ‹: 2020λ…„ 11μ›” 10μΌ 10:00:00 vs μ„λ²„ : 2020λ…„ 11μ›” 10μΌ 11:00:00
    - 200 OK, λ¨λ“  λ°μ΄ν„° μ „μ†΅(BODY ν¬ν•¨)
    - μ „μ†΅ μ©λ‰ 1.1M(ν—¤λ” 0.1M, λ°”λ”” 1.0M)

---

## π’© Last-Modified, if-Modified-Since λ‹¨μ 

- 1μ΄ λ―Έλ§ λ‹¨μ„λ΅ μΊμ‹ μ΅°μ •μ΄ λ¶κ°€λ¥
- λ‚ μ§ κΈ°λ°μ λ΅μ§ μ‚¬μ©
- λ°μ΄ν„°λ¥Ό μμ •ν•΄μ„ λ‚ μ§κ°€ λ‹¤λ¥΄μ§€λ§, κ°™μ€ λ°μ΄ν„°λ¥Ό μμ •ν•΄μ„ λ°μ΄ν„° κ²°κ³Όκ°€ λ‘κ°™μ€ κ²½μ°
- μ„λ²„μ—μ„ λ³„λ„μ μΊμ‹ λ΅μ§μ„ κ΄€λ¦¬ν•κ³  μ‹¶μ€ κ²½μ°
  - μ) μ¤νμ΄μ¤λ‚ μ£Όμ„μ²λΌ ν¬κ² μν–¥μ΄ μ—†λ” λ³€κ²½μ—μ„ μΊμ‹λ¥Ό μ μ§€ν•κ³  μ‹¶μ€ κ²½μ°

### Etag, if-None-Match

- ETag(Entity Tag)
- μΊμ‹μ© λ°μ΄ν„°μ— μ„μμ κ³ μ ν• λ²„μ „ μ΄λ¦„μ„ λ‹¬μ•„λ‘ 
- λ°μ΄ν„°κ°€ λ³€κ²½λλ©΄ μ΄ μ΄λ¦„μ„ λ°”κΎΈμ–΄μ„ λ³€κ²½ν•¨(Hashλ¥Ό λ‹¤μ‹ μƒμ„±)
- μ§„μ§ λ‹¨μν•κ² Etagλ§ λ³΄λ‚΄μ„ κ°™μΌλ©΄ μ μ§€, λ‹¤λ¥΄λ©΄ λ‹¤μ‹ λ°›κΈ°!

### Etag, if-None-Match μ •λ¦¬

- μ§„μ§ λ‹¨μν•κ² ETagλ§ μ„λ²„μ— λ³΄λ‚΄μ„ κ°™μΌλ©΄ μ μ§€, λ‹¤λ¥΄λ©΄ λ‹¤μ‹ λ°›κΈ°!

- μΊμ‹ μ μ–΄ λ΅μ§μ„ μ„λ²„μ—μ„ μ™„μ „ν κ΄€λ¦¬

- ν΄λΌμ΄μ–ΈνΈλ” λ‹¨μν μ΄ κ°’μ„ μ„λ²„μ— μ κ³µ(ν΄λΌμ΄μ–ΈνΈλ” μΊμ‹ λ§¤μ»¤λ‹μ¦μ„ λ¨λ¦„)

- μ)
  - μ„λ²„λ” λ°°νƒ€ μ¤ν” κΈ°κ°„μΈ 3μΌ λ™μ• νμΌμ΄ λ³€κ²½λμ–΄λ„ ETagλ¥Ό λ™μΌν•κ² μ μ§€
  - μ• ν”λ¦¬μΌ€μ΄μ… λ°°ν¬ μ£ΌκΈ°μ— λ§μ¶”μ–΄ ETag λ¨λ‘ κ°±μ‹ 

---

## π‘½οΈ μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”

### μΊμ‹ μ μ–΄ ν—¤λ”

1. Cache-Control : μΊμ‹ μ§€μ‹μ–΄

- Cache-Contorl: max-age

  - μΊμ‹ μ ν¨ μ‹κ°„, μ΄ λ‹¨μ„

- Cache-Control: no-cache

  - λ°μ΄ν„°λ” μΊμ‹ν•΄λ„ λμ§€λ§, ν•­μƒ μ›(origin) μ„λ²„μ— κ²€μ¦ν•κ³  μ‚¬μ©

- Cache-Control: no-store
  - λ°μ΄ν„°μ— λ―Όκ°ν• μ •λ³΄κ°€ μμΌλ―€λ΅ μ €μ¥ν•λ©΄ μ•λ¨
  - λ©”λ¨λ¦¬μ—μ„ μ‚¬μ©ν•κ³  μµλ€ν• λΉ¨λ¦¬ μ‚­μ ν•΄μ•Όν•λ‹¤.

2. Pragma : μΊμ‹ μ μ–΄(ν•μ„ νΈν™) λ‹¤λ§ κ±°μ§„ μ‚¬μ© μ•ν•¨ β

3. Expires : μΊμ‹ λ§λ£μΌ μ§€μ •(ν•μ„ νΈν™)

- μΊμ‹ λ§λ£μΌμ„ μ •ν™•ν• λ‚ μ§λ΅ μ§€μ •
- HTTP 1.0λ¶€ν„° μ‚¬μ©
- μ§€κΈμ€ λ” μ μ—°ν• <mark>Cache-Contorl: max-age κ¶μ¥</mark>
- Cache-Control: max-ageμ™€ ν•¨κ» μ‚¬μ©ν•λ©΄ Expiresλ” λ¬΄μ‹

---

## π”€ ν”„λ΅μ‹ μΊμ‹

### μ› μ„λ²„ μ§μ ‘ μ ‘κ·Ό (Origin μ„λ²„)

λΉ›μ€ μƒκ°λ³΄λ‹¤ λλ¦Ό .. κ·Έλμ„ κ³ μ•ν•κ³  λ§λ“¤μ–΄μ§„κ² ν”„λ΅μ‹ μΊμ‹ μ„λ²„

κ·Έλμ„ λ―Έκµ­μ—μ„ μ› μ„λ²„κ°€ μμΌλ©΄ ν•κµ­ μ–΄λ”κ°€μ— ν”„λ΅μ‹ μΊμ‹ μ„λ²„λ¥Ό λ§λ“¤μ–΄ λ‘ 

κ·Έλ¬λ©΄ ν΄λΌμ΄μ–ΈνΈλ” ν•κµ­μ— μλ” ν”„λ΅μ‹ μΊμ‹ μ„λ²„μ™€ ν†µμ‹ μ„ μ£Όκ³  λ°›μΌλ©΄ μ›μ„λ²„μ™€ ν•λ ν†µμ‹ λ“¤μ΄ ν›¨μ”¬ λΉ¨λΌμ§€κ² λλ‹¤.

### Cache-Control

μΊμ‹ μ§€μ‹μ–΄ - κΈ°νƒ€

- Cache-Control : public

  - μ‘λ‹µμ΄ public μΊμ‹μ— μ €μ¥λμ–΄λ„ λ¨

- Cache-Control : private

  - μ‘λ‹µμ΄ ν•΄λ‹Ή μ‚¬μ©μλ§μ„ μ„ν• κ²ƒμ„. private μΊμ‹μ— μ €μ¥ν•΄μ•Ό ν•¨(default)

- Cache-Control : s-maxage

  - ν”„λ΅μ‹ μΊμ‹μ—λ§ μ μ©λλ” max-age

- Age : 60 (HTTP ν—¤λ”)
  - μ¤λ¦¬μ§„ μ„λ²„μ—μ„ μ‘λ‹µ ν›„ ν”„λ΅μ‹ μΊμ‹ λ‚΄μ— λ¨Έλ¬Έ μ‹κ°„(μ΄)

---

## π”‡ μΊμ‰¬ λ¬΄ν¨ν™”

### ν™•μ‹¤ν• μΊμ‹ λ¬΄ν¨ν™” μ‘λ‹µ

- Cache-Control : no-cache, no-store, must-revalidate

- Pragma : no-cache
  - HTTP 1.0 ν•μ„ νΈν™

### μΊμ‹ μ§€μ‹μ–΄ - ν™•μ‹¤ν• μΊμ‹ λ¬΄ν¨ν™”

- Cache-Control : no-cache

  - λ°μ΄ν„°λ” μΊμ‹ν•΄λ„ λμ§€λ§, ν•­μƒ μ› μ„λ²„μ— κ²€μ¦ν•κ³  μ‚¬μ©(μ΄λ¦„μ— μ£Όμ)

- Cache-Control : no-store

  - λ°μ΄ν„°μ— λ―Όκ°ν• μ •λ³΄κ°€ μμΌλ―€λ΅ μ €μ¥ν•λ©΄ μ•λ¨, μ•„λ‹λ©΄ λ©”λ¨λ¦¬μ—μ„ μ‚¬μ©ν•κ³  μµλ€ν• λΉ¨λ¦¬ μ‚­μ 

- Cache-Control : must-revalidate

  - μΊμ‹ λ§λ£ ν›„ μµμ΄ μ΅°ν μ‹ μ› μ„λ²„μ— κ²€μ¦ν•΄μ•Όν•¨
  - μ› μ„λ²„ μ ‘κ·Ό μ‹¤ν¨μ‹ λ°λ“μ‹ μ¤λ¥κ°€ λ°μƒν•΄μ•Όν•¨ - 504(Gateway Timeout)
  - must-revalidateλ” μΊμ‹ μ ν¨ μ‹κ°„μ΄λΌλ©΄ μΊμ‹λ¥Ό μ‚¬μ©ν•¨

- Pragma : no-cache
  - HTTP 1.0 ν•μ„ νΈν™
